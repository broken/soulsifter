import { css, html, LitElement } from "@polymer/lit-element";

import "@polymer/paper-toast";

import { AlertsMixin } from "./mixin-alerts.js";
import "./icon-button.js";


class AlertList extends AlertsMixin(LitElement) {
  render() {
    let msg = html``;
    if (this.alerts.length) {
      let mo = this.alerts.slice(1).map(a => html`<hr>${a}`);
      msg = html`${this.alerts[0]}${mo}`;
    }
    return html`
      <paper-toast id="toast" class="fit-bottom" duration="0">
        ${msg}
        <icon-button @click=${this.rmAlert} icon="clear" id="clear"></icon-button>
      </paper-toast>
    `;
  }

  constructor() {
    super();
  }

  alertsChanged(x) {
    this.alerts = x;
    if (this.alerts.length > 0) {
      setTimeout(() => { this.shadowRoot.getElementById('toast').open(); }, 10);
    } else {
      this.shadowRoot.getElementById('toast').close();
    }
    this.requestUpdate();
  }

  static get styles() {
    return [
      css`
        #toast {
          --paper-toast-background-color: var(--ss-alert-list-bg-clr);
          --paper-toast-color: white;
        }
        icon-button {
          position: absolute;
          right: 12px;
          top: 12px;
        }
        hr{
          border-bottom: initial;
          border-top: 1px dotted red;
        }
      `
    ];
  }
}

window.customElements.define('alert-list', AlertList);
