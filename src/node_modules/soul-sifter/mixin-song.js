import { dedupingMixin } from '@polymer/polymer/lib/utils/mixin.js';

let songMixin = (superClass) => class extends superClass {

  static get properties() {
    return {
      song: { type: Object }
    };
  }

  constructor() {
    super();
    this._songListener = (e) => this._songChanged(e);
  }

  connectedCallback() {
    super.connectedCallback();
    console.log('conntected');
    window.addEventListener('song-changed', this._songListener);
  }

  disconnectedCallback() {
    console.log('disconne');
    window.removeEventListener('song-changed', this._songListener);
    super.disconnectedCallback();
  }

  changeSong(s) {
    let event = new CustomEvent('song-changed', { detail: this.song });
    window.dispatchEvent(event);
  }

  _songChanged(e) {
    songChanged(e.detail);
  }

  songChanged(s) {
    /* do nothing */
  }
}

export const SongMixin = dedupingMixin(songMixin);
