<link href="../polymer/polymer.html" rel="import">

<link href="genre-list-item.html" rel="import">


<dom-module id="genre-list">
  <style is="custom-style">
  </style>
  <template>
    <template is="dom-repeat" items="[[genreParents]]" id="genreTpl">
      <genre-list-item genre="[[item]]" on-genre-select="_selectGenre"></genre-list-item>
    </template>
    <array-selector id="selector" items="[[allGenres]]" selected="{{selection}}" multi toggle></array-selector>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'genre-list',

    properties: {
      genreParents: {
        type: Array,
        value: function() { return ss.Style.findAllParents(); }
      },
      allGenres: {
        type: Array,
        value: function() { return ss.Style.findAll(); },
        readOnly: true
      },
      selection: {
        type: Array,
        notify: true
      }
    },

    // Does this even work? Seems like it only sets parents...
    setSelection: function(genres) {
      for (var i = 0, item = this.$.genreTpl.nextElementSibling;
          item && i < this.genreParents.length;
          item = item.nextElementSibling, ++i) {
        item.selectIfInArray(genres);
      }
    },

    _selectGenre: function(e, detail) {
      this.$.selector.select(detail.genre);
    },
    
  });
</script>
